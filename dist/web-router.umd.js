!function(e,t){"object"==typeof exports&&"undefined"!=typeof module?t(exports,require("lodash")):"function"==typeof define&&define.amd?define(["exports","lodash"],t):t((e=e||self).webRouterJs={},e.lodash)}(this,function(e,t){function n(e,t){for(var n=0;n<t.length;n++){var o=t[n];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(e,o.key,o)}}t=t&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t;var o={},i=!1,r=!0,l=null,s=["[data-navigo]","[data-route]"],u=s.slice(0),a=null;function c(e,n,o,i){void 0===o&&(o=null),void 0===i&&(i=function(){}),t.isFunction(n.hooks[e])?n.hooks[e](function(e){void 0===e&&(e=!0),e&&i(e)},o):t.isArray(n.hooks[e])?function e(n,o,i){if(void 0===o&&(o=null),!n.length)return i(!0);var r=t.head(n);t.isFunction(r)&&r(function(r){if(void 0===r&&(r=!0),!r)return i(!1);e(t.tail(n),o,i)})}(n.hooks[e],o,function(e){void 0===e&&(e=!0),e&&i(e)}):i()}function f(e,n){return void 0===n&&(n=null),c("before",e,n,function(o){t.isArray(n)?e.method.apply({},n):e.method(n)})}function d(e,t,n){return void 0===t&&(t=null),void 0===n&&(n=function(e){}),c("after",e,t,n)}function h(e){var t,n;return l&&(i&&console.log("was a last resolve",l),void 0===(t=e)&&(t=null),void 0===n&&(n=function(e){}),c("leave",l,t,n)),this.resolve(),this}function v(e){return Object.assign(this,e),this}e.WebRouter=function(){function e(e){for(var t in void 0===e&&(e={}),l=null,e)this.on(t,e[t]);r&&(this.listen(),this.updatePageLinks())}var c,g,p,y=e.prototype;return y.on=function(e,n,r){void 0===e&&(e="/"),void 0===r&&(r={}),i&&console.log(".on(",e,n,r,")");var l=e,s=!1,u=[];if(t.isRegExp(e))s=!0,l=e.toString();else{var a=l.split("/").map(function(e){return e.startsWith(":")?(s=!0,u.push(e.slice(1)),"([^/]{1,})"):e});e=new RegExp("^"+a.join("/")+"$")}return o[l]=new v({name:l,regExp:s?e:null,regExpKeys:u,method:n,hooks:r}),this},y.off=function(){var t=[].slice.call(arguments);if(i&&console.log(".off(",t,")"),0===t.length)e.reset(),window.removeEventListener("popstate",h.bind(this),!1),delete window.hasListenerAttached;else{var n=t[0];delete o[n]}return this},y.listen=function(){return window.hasListenerAttached||(i&&console.log("listen() Attaching to window"),window.addEventListener("popstate",h.bind(this),!1),window.hasListenerAttached=!0),this},y.updatePageLinks=function(e){var n=this;return void 0===e&&(e=null),i&&console.log("updatePageLinks",u),u.forEach(function(o){var r=document.querySelectorAll(o);t.forEach(r,function(t){t.hasListenerAttached||t.addEventListener("click",function(t){if(i&&console.log("CLICKED. Now navigate",t),(t.ctrlKey||t.metaKey)&&"a"===t.target.tagName.toLowerCase())return!1;t.preventDefault();var o=t.target.getAttribute("href");e?e.call(n,o):n.navigate(o)},!1),t.hasListenerAttached=!0})}),this},y.navigate=function(e,t){return void 0===t&&(t=null),window.history.pushState(t,null,e),this.resolve(),this},y.notFound=function(e){return t.isFunction(e)&&(a=e),this},y.resolve=function(e){void 0===e&&(e=window.location.pathname),i&&console.log("Resolve",e);var t=!1,n=function(n){var i=o[n];if(i.regExp){if(i.regExp){var r=e.match(i.regExp)||[],s=r.slice(1,i.regExpKeys.length+1),u={};if(r&&r.length){s.forEach(function(e,t){u[i.regExpKeys[t]]=e});var a=i.regExpKeys.length?u:r.slice(1);t=!0,l=i,f(i,a),d(i,a)}}}else n===e&&(t=!0,l=i,f(i,{}),d(i,null))};for(var r in o)n(r);return t?i&&console.log("Route Matched",l):(l=null,a&&(i&&console.log("notFound"),a.call(this))),this},e.reset=function(){o={},r=!0,l=null,a=null,u=s.slice(0)},e.addPageLinkSelectors=function(e){var n;void 0===e&&(e=[]),(n=u).push.apply(n,e),u=t.unique(u)},c=e,p=[{key:"autoListen",set:function(e){return r=!!e}},{key:"routes",get:function(){return o}},{key:"lastResolved",get:function(){return l}},{key:"debug",set:function(e){i=!!e}}],(g=[{key:"all",get:function(){return o}}])&&n(c.prototype,g),p&&n(c,p),e}()});
//# sourceMappingURL=web-router.umd.js.map
